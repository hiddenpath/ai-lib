# ai-lib é¡¹ç›®å…¨é¢ä»£ç å®¡æŸ¥æŠ¥å‘Š

**å®¡æŸ¥æ—¥æœŸ**: 2025-01-XX  
**å®¡æŸ¥è§’è‰²**: é¡¹ç›®æ€»ç›‘ & é¦–å¸­å·¥ç¨‹å¸ˆ  
**å®¡æŸ¥èŒƒå›´**: å…¨é¡¹ç›®ä»£ç åº“

---

## æ‰§è¡Œæ‘˜è¦

æœ¬æ¬¡å®¡æŸ¥é‡ç‚¹å…³æ³¨ä¸‰ä¸ªæ ¸å¿ƒé—®é¢˜ï¼š
1. Provideræ„å»ºç­–ç•¥ä»æ··åˆç­–ç•¥è½¬ç§»åˆ°æ•°æ®é©±åŠ¨ç­–ç•¥çš„æ•ˆæœè¯„ä¼°
2. é¡¹ç›®ç»“æ„ä¼˜åŒ–å’Œé‡æ„å»ºè®®
3. ä»£ç é€»è¾‘é”™è¯¯å’Œè­¦å‘Šçš„è¯†åˆ«ä¸ä¿®å¤

---

## ä¸€ã€Provideræ„å»ºç­–ç•¥è½¬å˜åˆ†æ

### 1.1 ç­–ç•¥æ¼”è¿›å†ç¨‹

#### æ··åˆç­–ç•¥ï¼ˆv0.4.0åŠä¹‹å‰ï¼‰
æ ¹æ® `docs/architecture/ADR-001-hybrid-architecture.md`ï¼Œé¡¹ç›®æœ€åˆé‡‡ç”¨æ··åˆæ¶æ„ï¼š

- **Config-Driven Adapters (GenericAdapter)**: ç”¨äºOpenAIå…¼å®¹çš„æä¾›å•†
- **Independent Adapters**: ç”¨äºç‹¬ç‰¹APIçš„æä¾›å•†ï¼ˆGemini, Mistral, Cohereç­‰ï¼‰

**ç‰¹ç‚¹**:
- ä»£ç è·¯å¾„åˆ†ä¸ºä¸¤ç±»ï¼Œéœ€è¦ç»´æŠ¤ä¸¤å¥—é€»è¾‘
- æ–°å¢OpenAIå…¼å®¹æä¾›å•†åªéœ€é…ç½®ï¼Œä½†éœ€è¦ä¿®æ”¹ä»£ç æ·»åŠ æ–°çš„Provideræšä¸¾
- ç±»å‹å®‰å…¨ä½†å­˜åœ¨ä»£ç é‡å¤

#### æ•°æ®é©±åŠ¨ç­–ç•¥ï¼ˆv0.5.0+ï¼‰
å½“å‰å®ç°åŸºäº `models.json` æ³¨å†Œè¡¨ï¼š

```rust
// æ ¸å¿ƒç»„ä»¶
- ModelRegistry (src/registry/mod.rs)
- ProviderFactory (src/client/provider_factory.rs)  
- models.json (src/defaults/models.json)
```

**æ¶æ„æµç¨‹**:
```
AiClientBuilder::with_model("gpt-4o")
  â†“
ModelRegistry.resolve_model() â†’ ModelInfo
  â†“
ModelRegistry.resolve_provider() â†’ ProviderConfig
  â†“
ProviderFactory::create(protocol, config, transport)
  â†“
GenericAdapter / NativeAdapter
```

### 1.2 æ•ˆæœè¯„ä¼°

#### âœ… ä¼˜åŠ¿

1. **å¯æ‰©å±•æ€§æ˜¾è‘—æå‡**
   - æ–°å¢æä¾›å•†æ— éœ€ä¿®æ”¹ä»£ç ï¼Œåªéœ€æ›´æ–° `models.json`
   - æ”¯æŒçƒ­é‡è½½ï¼ˆ`config_hot_reload` featureï¼‰
   - æ¨¡å‹å’Œæä¾›å•†é…ç½®å®Œå…¨è§£è€¦

2. **ä»£ç ç®€åŒ–**
   - `ProviderFactory::create()` ç»Ÿä¸€äº†åˆ›å»ºé€»è¾‘
   - å‡å°‘äº†ç¡¬ç¼–ç çš„Provideræšä¸¾ä¾èµ–
   - åè®®é©±åŠ¨çš„é€‚é…å™¨é€‰æ‹©ï¼ˆ"openai", "anthropic", "gemini"ç­‰ï¼‰

3. **é…ç½®é›†ä¸­ç®¡ç†**
   - æ‰€æœ‰æä¾›å•†é…ç½®é›†ä¸­åœ¨JSONæ–‡ä»¶ä¸­
   - æ”¯æŒè¿è¡Œæ—¶é…ç½®æ›´æ–°
   - ä¾¿äºç‰ˆæœ¬æ§åˆ¶å’Œé…ç½®ç®¡ç†

4. **å‘åå…¼å®¹**
   - ä¿ç•™äº† `Provider` æšä¸¾ç”¨äºå‘åå…¼å®¹
   - `ProviderFactory::create_adapter()` æä¾›legacyè·¯å¾„
   - ç°æœ‰ä»£ç æ— éœ€ä¿®æ”¹å³å¯å·¥ä½œ

#### âš ï¸ æŒ‘æˆ˜ä¸é—®é¢˜

1. **åŒé‡è·¯å¾„å¤æ‚æ€§**
   ```rust
   // Path A: Model-driven (Preferred)
   if let Some(ref model_id) = self.model_id { ... }
   
   // Path B: Legacy Provider-driven  
   else { ... }
   ```
   - `builder.rs` ä¸­å­˜åœ¨ä¸¤å¥—é€»è¾‘ï¼Œå¢åŠ äº†è®¤çŸ¥è´Ÿæ‹…
   - éœ€è¦åŒæ—¶ç»´æŠ¤æšä¸¾æ˜ å°„å’Œæ³¨å†Œè¡¨

2. **ç±»å‹å®‰å…¨é™ä½**
   - åè®®å­—ç¬¦ä¸²ï¼ˆ"openai"ï¼‰ä¸å¦‚æšä¸¾ç±»å‹å®‰å…¨
   - è¿è¡Œæ—¶é”™è¯¯å¯èƒ½å»¶è¿Ÿåˆ°å®é™…è°ƒç”¨æ—¶æ‰å‘ç°

3. **é…ç½®éªŒè¯ä¸è¶³**
   - `models.json` çš„éªŒè¯ä»…åœ¨è¿è¡Œæ—¶è¿›è¡Œ
   - ç¼ºå°‘ç¼–è¯‘æ—¶é…ç½®éªŒè¯æœºåˆ¶

4. **unsafeä»£ç ä½¿ç”¨**
   ```rust
   // src/client/provider_factory.rs:149
   unsafe {
       std::env::set_var(provider.env_prefix(), key);
   }
   ```
   - åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­è®¾ç½®ç¯å¢ƒå˜é‡æ˜¯ä¸å®‰å…¨çš„
   - åº”è¯¥é€šè¿‡é…ç½®ä¼ é€’è€Œéä¿®æ”¹å…¨å±€ç¯å¢ƒ

### 1.3 æ”¹è¿›å»ºè®®

1. **ç»Ÿä¸€è·¯å¾„ï¼Œæ¶ˆé™¤åŒé‡é€»è¾‘**
   - å°†Provideræšä¸¾å®Œå…¨æ˜ å°„åˆ°æ³¨å†Œè¡¨
   - ç§»é™¤legacyè·¯å¾„ï¼Œç»Ÿä¸€ä½¿ç”¨æ³¨å†Œè¡¨è§£æ
   - æä¾›è¿ç§»å·¥å…·å¸®åŠ©ç”¨æˆ·è¿‡æ¸¡

2. **å¢å¼ºç±»å‹å®‰å…¨**
   - å¼•å…¥ `Protocol` æšä¸¾æ›¿ä»£å­—ç¬¦ä¸²
   - ç¼–è¯‘æ—¶éªŒè¯ `models.json` ç»“æ„
   - ä½¿ç”¨å®ç”Ÿæˆç±»å‹å®‰å…¨çš„é…ç½®è®¿é—®å™¨

3. **ç§»é™¤unsafeä»£ç **
   - å°†API keyä½œä¸ºå‚æ•°ä¼ é€’ï¼Œè€Œéè®¾ç½®ç¯å¢ƒå˜é‡
   - ä½¿ç”¨é…ç½®ç»“æ„ä½“è€Œéå…¨å±€çŠ¶æ€

4. **å®Œå–„æ–‡æ¡£**
   - æ›´æ–°æ¶æ„æ–‡æ¡£è¯´æ˜æ•°æ®é©±åŠ¨ç­–ç•¥
   - æä¾›è¿ç§»æŒ‡å—
   - æ·»åŠ é…ç½®éªŒè¯æœ€ä½³å®è·µ

---

## äºŒã€é¡¹ç›®ç»“æ„ä¼˜åŒ–å»ºè®®

### 2.1 å½“å‰ç»“æ„åˆ†æ

```
src/
â”œâ”€â”€ api/              # APIæ¥å£å®šä¹‰
â”œâ”€â”€ client/            # å®¢æˆ·ç«¯å®ç°
â”‚   â”œâ”€â”€ builder.rs     # æ„å»ºå™¨ï¼ˆ643è¡Œï¼Œè¾ƒå¤æ‚ï¼‰
â”‚   â”œâ”€â”€ provider_factory.rs  # Providerå·¥å‚
â”‚   â””â”€â”€ ...
â”œâ”€â”€ provider/          # Provideré€‚é…å™¨
â”‚   â”œâ”€â”€ generic.rs     # é€šç”¨é€‚é…å™¨
â”‚   â”œâ”€â”€ builders.rs    # Builderæ¨¡å¼
â”‚   â”œâ”€â”€ configs.rs     # é…ç½®å®šä¹‰
â”‚   â””â”€â”€ ...
â”œâ”€â”€ registry/          # æ³¨å†Œè¡¨ï¼ˆæ•°æ®é©±åŠ¨æ ¸å¿ƒï¼‰
â”œâ”€â”€ model/             # æ¨¡å‹è§£æ
â”œâ”€â”€ transport/          # ä¼ è¾“å±‚
â”œâ”€â”€ types/              # ç±»å‹å®šä¹‰
â””â”€â”€ ...
```

### 2.2 å‘ç°çš„é—®é¢˜

#### é—®é¢˜1: èŒè´£è¾¹ç•Œæ¨¡ç³Š

**`client/builder.rs` è¿‡äºå¤æ‚ï¼ˆ643è¡Œï¼‰**
- åŒæ—¶è´Ÿè´£ï¼šæ„å»ºé€»è¾‘ã€æ³¨å†Œè¡¨è§£æã€ä¼ è¾“é…ç½®ã€æ‹¦æˆªå™¨è®¾ç½®
- å»ºè®®æ‹†åˆ†ï¼š
  ```rust
  client/
  â”œâ”€â”€ builder.rs           # æ ¸å¿ƒæ„å»ºé€»è¾‘
  â”œâ”€â”€ registry_resolver.rs # æ³¨å†Œè¡¨è§£æ
  â”œâ”€â”€ transport_builder.rs # ä¼ è¾“å±‚æ„å»º
  â””â”€â”€ interceptor_builder.rs # æ‹¦æˆªå™¨æ„å»º
  ```

#### é—®é¢˜2: é…ç½®åˆ†æ•£

**é…ç½®å®šä¹‰åˆ†æ•£åœ¨å¤šä¸ªä½ç½®**:
- `provider/config.rs` - ProviderConfig (legacy)
- `provider/configs.rs` - ProviderConfigs (é¢„å®šä¹‰é…ç½®)
- `registry/model.rs` - ProviderConfig (æ–°æ³¨å†Œè¡¨)
- `defaults/models.json` - JSONé…ç½®

**å»ºè®®**: ç»Ÿä¸€é…ç½®æ¨¡å‹
```rust
config/
â”œâ”€â”€ mod.rs              # ç»Ÿä¸€é…ç½®å…¥å£
â”œâ”€â”€ provider.rs         # Provideré…ç½®
â”œâ”€â”€ model.rs            # Modelé…ç½®
â””â”€â”€ registry.rs         # æ³¨å†Œè¡¨é…ç½®
```

#### é—®é¢˜3: æ¨¡å—ä¾èµ–å¾ªç¯é£é™©

**ä¾èµ–å…³ç³»**:
```
client â†’ provider â†’ transport
client â†’ registry â†’ (æ— ä¾èµ–ï¼Œå¥½)
provider â†’ client (é€šè¿‡traitï¼Œå¯æ¥å—)
```

**å»ºè®®**: æ˜ç¡®ä¾èµ–æ–¹å‘ï¼Œé¿å…å¾ªç¯
- `client` ä¾èµ– `provider` å’Œ `registry`
- `provider` ä¾èµ– `transport` å’Œ `api`
- `registry` ç‹¬ç«‹ï¼Œä¸ä¾èµ–å…¶ä»–æ¨¡å—

#### é—®é¢˜4: Featureé—¨æ§å¤æ‚

**å½“å‰features**:
- `interceptors`, `unified_transport`, `unified_sse`
- `cost_metrics`, `routing_mvp`, `observability`
- `config_hot_reload`, `response_parser`

**é—®é¢˜**: Featureç»„åˆå¯èƒ½å¯¼è‡´é…ç½®å†²çª

**å»ºè®®**: 
- æ˜ç¡®featureä¾èµ–å…³ç³»
- æä¾›featureç»„åˆçš„é¢„è®¾ï¼ˆå¦‚ `all`ï¼‰
- æ–‡æ¡£åŒ–featureå…¼å®¹æ€§çŸ©é˜µ

### 2.3 é‡æ„å»ºè®®

#### å»ºè®®1: å¼•å…¥é…ç½®å±‚æŠ½è±¡

```rust
// src/config/mod.rs
pub trait ConfigProvider {
    fn resolve_provider(&self, id: &str) -> Result<ProviderConfig>;
    fn resolve_model(&self, id: &str) -> Result<ModelInfo>;
}

// å®ç°
pub struct EmbeddedConfigProvider;  // ä½¿ç”¨models.json
pub struct FileConfigProvider;     // ä»æ–‡ä»¶åŠ è½½
pub struct RemoteConfigProvider;    // ä»è¿œç¨‹åŠ è½½
```

#### å»ºè®®2: ç®€åŒ–Builderæ¨¡å¼

å½“å‰Builderæœ‰30+æ–¹æ³•ï¼Œå»ºè®®åˆ†å±‚ï¼š

```rust
// åŸºç¡€æ„å»º
AiClientBuilder::new(Provider)

// é…ç½®å±‚ï¼ˆé“¾å¼ï¼‰
.with_model() / .with_provider_config()

// ä¼ è¾“å±‚
.with_transport_config()

// é«˜çº§åŠŸèƒ½ï¼ˆfeature-gatedï¼‰
#[cfg(feature = "interceptors")]
.with_interceptors()
```

#### å»ºè®®3: ç»Ÿä¸€é”™è¯¯å¤„ç†

å½“å‰é”™è¯¯ç±»å‹åˆ†æ•£ï¼š
- `types::error::AiLibError`
- `transport::error::TransportError`

å»ºè®®ï¼šç»Ÿä¸€é”™è¯¯å±‚æ¬¡
```rust
error/
â”œâ”€â”€ mod.rs           # ç»Ÿä¸€é”™è¯¯ç±»å‹
â”œâ”€â”€ provider.rs      # Providerç›¸å…³é”™è¯¯
â”œâ”€â”€ transport.rs     # ä¼ è¾“é”™è¯¯
â””â”€â”€ config.rs        # é…ç½®é”™è¯¯
```

---

## ä¸‰ã€ä»£ç é€»è¾‘é”™è¯¯ä¸è­¦å‘Šä¿®å¤

### 3.1 å·²ä¿®å¤çš„é”™è¯¯

#### âœ… é”™è¯¯1: InvalidConfiguration â†’ ConfigurationError
**ä½ç½®**: `src/client/builder.rs:260, 266`
**é—®é¢˜**: ä½¿ç”¨äº†ä¸å­˜åœ¨çš„é”™è¯¯å˜ä½“
**ä¿®å¤**: ç»Ÿä¸€ä½¿ç”¨ `AiLibError::ConfigurationError`

#### âœ… é”™è¯¯2: unused_assignmentsè­¦å‘Š
**ä½ç½®**: `src/client/builder.rs:247, 415`
**é—®é¢˜**: `resolved_protocol` åˆå§‹åŒ–åå¯èƒ½è¢«è¦†ç›–
**ä¿®å¤**: æ”¹ä¸ºå»¶è¿Ÿåˆå§‹åŒ–ï¼Œä½¿ç”¨if-elseè¡¨è¾¾å¼ç›´æ¥èµ‹å€¼

#### âœ… é”™è¯¯3: model_driven.rsç±»å‹é”™è¯¯
**ä½ç½®**: `examples/model_driven.rs:45`
**é—®é¢˜**: `response.usage` æ˜¯ `Usage` ç±»å‹ï¼Œä¸æ˜¯ `Option<Usage>`
**ä¿®å¤**: ç§»é™¤ `if let Some(usage)` åŒ…è£…ï¼Œç›´æ¥ä½¿ç”¨

### 3.2 å¾…ä¿®å¤çš„è­¦å‘Š

#### âš ï¸ è­¦å‘Š1: æœªä½¿ç”¨çš„å¯¼å…¥
**ä½ç½®**: å¤šä¸ªæ–‡ä»¶
- `src/client/provider_factory.rs:11` - `OpenAiAdapter` (å·²ç§»é™¤ä½†å¯¼å…¥ä»åœ¨)
- `src/registry/mod.rs:6` - `Arc` (æœªä½¿ç”¨)
- å¤šä¸ªexamplesæ–‡ä»¶æœ‰æœªä½¿ç”¨çš„å¯¼å…¥

**å»ºè®®**: è¿è¡Œ `cargo clippy --fix` è‡ªåŠ¨æ¸…ç†

#### âš ï¸ è­¦å‘Š2: unsafeä»£ç ä½¿ç”¨
**ä½ç½®**: `src/client/provider_factory.rs:149`
```rust
unsafe {
    std::env::set_var(provider.env_prefix(), key);
}
```

**é—®é¢˜**: 
- å¤šçº¿ç¨‹ä¸å®‰å…¨
- å¯èƒ½å½±å“å…¶ä»–ä»£ç è·¯å¾„

**å»ºè®®**: 
```rust
// æ–¹æ¡ˆ1: é€šè¿‡é…ç½®ä¼ é€’
ProviderFactory::create(protocol, config.with_api_key(key), transport)

// æ–¹æ¡ˆ2: ä½¿ç”¨çº¿ç¨‹å±€éƒ¨å˜é‡
thread_local! {
    static API_KEY: RefCell<Option<String>> = RefCell::new(None);
}
```

#### âš ï¸ è­¦å‘Š3: response_parser featureç¼ºå¤±
**ä½ç½®**: 
- `examples/response_parsing.rs:6`
- `tests/response_parser_tests.rs:3`

**é—®é¢˜**: ä»£ç ä½¿ç”¨äº† `response_parser` ä½†featureæœªå¯ç”¨

**å»ºè®®**: 
- åœ¨examplesçš„Cargo.tomlä¸­å¯ç”¨feature
- æˆ–æ·»åŠ feature-gatedå¯¼å…¥

### 3.3 æ½œåœ¨é€»è¾‘é”™è¯¯

#### ğŸ” æ½œåœ¨é—®é¢˜1: æ³¨å†Œè¡¨å¹¶å‘å®‰å…¨
**ä½ç½®**: `src/registry/mod.rs`

```rust
pub struct ModelRegistry {
    models: RwLock<HashMap<String, ModelInfo>>,
    providers: RwLock<HashMap<String, ProviderConfig>>,
}
```

**é—®é¢˜**: 
- `RwLock` å¯èƒ½å¯¼è‡´å†™é”ç«äº‰
- `merge_config` éœ€è¦å†™é”ï¼Œå¯èƒ½é˜»å¡è¯»å–

**å»ºè®®**: 
- ä½¿ç”¨ `Arc<HashMap>` + åŸå­æ›´æ–°
- æˆ–ä½¿ç”¨ `dashmap` crate æä¾›å¹¶å‘HashMap

#### ğŸ” æ½œåœ¨é—®é¢˜2: é…ç½®è¦†ç›–é¡ºåº
**ä½ç½®**: `src/client/builder.rs:296-303`

```rust
if let Some(mut config) = resolved_provider_config {
    if let Some(url) = self.base_url {
        config.base_url = Some(url);
    }
    if config.base_url.is_none() {
        config.base_url = Some(base_url.clone());
    }
}
```

**é—®é¢˜**: é…ç½®è¦†ç›–é€»è¾‘å¯èƒ½ä¸å¤Ÿæ¸…æ™°

**å»ºè®®**: æ˜ç¡®ä¼˜å…ˆçº§
```rust
// ä¼˜å…ˆçº§: explicit > registry > default
config.base_url = self.base_url
    .or_else(|| config.base_url.clone())
    .or_else(|| Some(base_url.clone()));
```

#### ğŸ” æ½œåœ¨é—®é¢˜3: é”™è¯¯å¤„ç†ä¸ä¸€è‡´
**ä½ç½®**: å¤šä¸ªæ–‡ä»¶

**é—®é¢˜**: 
- æœ‰äº›åœ°æ–¹è¿”å› `Result<T, AiLibError>`
- æœ‰äº›åœ°æ–¹ä½¿ç”¨ `unwrap()` æˆ– `expect()`
- é”™è¯¯æ¶ˆæ¯æ ¼å¼ä¸ç»Ÿä¸€

**å»ºè®®**: 
- ç»Ÿä¸€é”™è¯¯å¤„ç†ç­–ç•¥
- æ·»åŠ é”™è¯¯ä¸Šä¸‹æ–‡
- ä½¿ç”¨ `thiserror` æä¾›ç»“æ„åŒ–é”™è¯¯

---

## å››ã€æ€§èƒ½ä¸å¯ç»´æŠ¤æ€§è¯„ä¼°

### 4.1 æ€§èƒ½è€ƒè™‘

#### âœ… ä¼˜åŠ¿
- æ³¨å†Œè¡¨ä½¿ç”¨ `HashMap` æä¾›O(1)æŸ¥æ‰¾
- é…ç½®åœ¨å¯åŠ¨æ—¶åŠ è½½ï¼Œè¿è¡Œæ—¶æ— é¢å¤–å¼€é”€
- ä½¿ç”¨ `Arc` å…±äº«é…ç½®ï¼Œå‡å°‘å†…å­˜å ç”¨

#### âš ï¸ æ”¹è¿›ç©ºé—´
- `RwLock` å¯èƒ½æˆä¸ºå¹¶å‘ç“¶é¢ˆ
- é…ç½®å…‹éš†å¯èƒ½äº§ç”Ÿä¸å¿…è¦çš„åˆ†é…
- è€ƒè™‘ä½¿ç”¨ `Cow` å‡å°‘å…‹éš†

### 4.2 å¯ç»´æŠ¤æ€§

#### âœ… ä¼˜åŠ¿
- æ¨¡å—åŒ–è®¾è®¡æ¸…æ™°
- Featureé—¨æ§å…è®¸æ¸è¿›å¼é‡‡ç”¨
- æ–‡æ¡£ç›¸å¯¹å®Œå–„

#### âš ï¸ æ”¹è¿›ç©ºé—´
- ä»£ç é‡å¤ï¼ˆbuilder.rsä¸­ä¸¤å¤„ç›¸ä¼¼é€»è¾‘ï¼‰
- é…ç½®åˆ†æ•£åœ¨å¤šä¸ªä½ç½®
- ç¼ºå°‘é›†æˆæµ‹è¯•è¦†ç›–

---

## äº”ã€æ€»ç»“ä¸å»ºè®®

### 5.1 ç­–ç•¥è½¬å˜è¯„ä¼°

**æ€»ä½“è¯„ä»·**: âœ… **æˆåŠŸ**

æ•°æ®é©±åŠ¨ç­–ç•¥æ˜¾è‘—æå‡äº†é¡¹ç›®çš„å¯æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚ä¸»è¦æˆæœï¼š
- æ–°å¢æä¾›å•†æˆæœ¬ä»"ä¿®æ”¹ä»£ç +æµ‹è¯•"é™ä½åˆ°"æ›´æ–°JSONé…ç½®"
- é…ç½®é›†ä¸­ç®¡ç†ï¼Œä¾¿äºç‰ˆæœ¬æ§åˆ¶
- æ”¯æŒè¿è¡Œæ—¶é…ç½®æ›´æ–°

**éœ€è¦æ”¹è¿›**:
- æ¶ˆé™¤åŒé‡è·¯å¾„ï¼Œç»Ÿä¸€åˆ°æ³¨å†Œè¡¨
- å¢å¼ºç±»å‹å®‰å…¨
- ç§»é™¤unsafeä»£ç 

### 5.2 ç»“æ„ä¼˜åŒ–ä¼˜å…ˆçº§

**é«˜ä¼˜å…ˆçº§**:
1. æ‹†åˆ† `builder.rs`ï¼Œé™ä½å¤æ‚åº¦
2. ç»Ÿä¸€é…ç½®æ¨¡å‹
3. ä¿®å¤unsafeä»£ç 

**ä¸­ä¼˜å…ˆçº§**:
4. å¼•å…¥é…ç½®å±‚æŠ½è±¡
5. ä¼˜åŒ–é”™è¯¯å¤„ç†
6. æ”¹è¿›å¹¶å‘å®‰å…¨

**ä½ä¼˜å…ˆçº§**:
7. é‡æ„featureé—¨æ§
8. æ€§èƒ½ä¼˜åŒ–

### 5.3 ä»£ç è´¨é‡

**å½“å‰çŠ¶æ€**: ğŸŸ¡ **è‰¯å¥½ï¼Œæœ‰æ”¹è¿›ç©ºé—´**

- âœ… æ ¸å¿ƒåŠŸèƒ½ç¨³å®š
- âœ… æ¶æ„è®¾è®¡åˆç†
- âš ï¸ å­˜åœ¨ä¸€äº›æŠ€æœ¯å€ºåŠ¡
- âš ï¸ éœ€è¦æ›´å¤šæµ‹è¯•è¦†ç›–

### 5.4 ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³ä¿®å¤** (æœ¬å‘¨):
   - [ ] ä¿®å¤æ‰€æœ‰ç¼–è¯‘è­¦å‘Š
   - [ ] ç§»é™¤unsafeä»£ç 
   - [ ] ä¿®å¤response_parser featureé—®é¢˜

2. **çŸ­æœŸæ”¹è¿›** (æœ¬æœˆ):
   - [ ] æ‹†åˆ†builder.rs
   - [ ] ç»Ÿä¸€é…ç½®æ¨¡å‹
   - [ ] å¢å¼ºé”™è¯¯å¤„ç†

3. **é•¿æœŸä¼˜åŒ–** (ä¸‹å­£åº¦):
   - [ ] å¼•å…¥é…ç½®å±‚æŠ½è±¡
   - [ ] æ€§èƒ½ä¼˜åŒ–
   - [ ] å®Œå–„æµ‹è¯•è¦†ç›–

---

## é™„å½•ï¼šä»£ç å®¡æŸ¥æ£€æŸ¥æ¸…å•

- [x] Provideræ„å»ºç­–ç•¥åˆ†æ
- [x] é¡¹ç›®ç»“æ„è¯„ä¼°
- [x] ä»£ç é€»è¾‘é”™è¯¯è¯†åˆ«
- [x] ç¼–è¯‘è­¦å‘Šä¿®å¤
- [x] æ½œåœ¨é—®é¢˜è¯†åˆ«
- [x] æ€§èƒ½è¯„ä¼°
- [x] å¯ç»´æŠ¤æ€§è¯„ä¼°
- [ ] æµ‹è¯•è¦†ç›–è¯„ä¼°ï¼ˆå¾…è¡¥å……ï¼‰
- [ ] æ–‡æ¡£å®Œæ•´æ€§è¯„ä¼°ï¼ˆå¾…è¡¥å……ï¼‰
- [ ] å®‰å…¨æ€§è¯„ä¼°ï¼ˆå¾…è¡¥å……ï¼‰

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-01-XX  
**å®¡æŸ¥äºº**: AI Assistant (ä½œä¸ºé¡¹ç›®æ€»ç›‘å’Œé¦–å¸­å·¥ç¨‹å¸ˆ)  
**æŠ¥å‘Šç‰ˆæœ¬**: 1.0

